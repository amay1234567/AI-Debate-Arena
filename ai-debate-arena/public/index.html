<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Debate Arena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="bg-white rounded-xl shadow-2xl p-8 max-w-4xl w-full">
        <h1 class="text-4xl font-extrabold text-center mb-2 text-gray-900">AI Debate Arena</h1>
        <p class="text-center text-gray-600 mb-8">Enter a topic and let the AI debate begin!</p>

        <div class="flex flex-col md:flex-row items-stretch gap-4 mb-8">
            <input type="text" id="topicInput" placeholder="e.g., 'The benefits of remote work'"
                   class="flex-grow p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200">
            <button id="generateBtn"
                    class="w-full md:w-auto px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200">
                Generate Arguments
            </button>
        </div>

        <div id="messageBox" class="hidden text-center bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl relative mb-4">
            <span id="messageText"></span>
        </div>

        <div id="debateContainer" class="grid grid-cols-1 md:grid-cols-2 gap-8 hidden">
            <!-- Pro Argument Section -->
            <div class="argument-card bg-gray-50 p-6 rounded-xl border border-gray-200 shadow-inner flex flex-col h-full">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Argument For</h2>
                <div id="proArgument" class="text-gray-700 flex-grow text-justify"></div>
                <div class="flex items-center justify-between mt-4">
                    <button id="proScoreBtn" class="px-4 py-2 bg-green-500 text-white font-semibold rounded-full shadow-lg hover:bg-green-600 transition-colors duration-200">
                        Stronger
                    </button>
                    <span id="proScore" class="text-xl font-bold text-green-700">0</span>
                </div>
            </div>

            <!-- Con Argument Section -->
            <div class="argument-card bg-gray-50 p-6 rounded-xl border border-gray-200 shadow-inner flex flex-col h-full">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Argument Against</h2>
                <div id="conArgument" class="text-gray-700 flex-grow text-justify"></div>
                <div class="flex items-center justify-between mt-4">
                    <button id="conScoreBtn" class="px-4 py-2 bg-red-500 text-white font-semibold rounded-full shadow-lg hover:bg-red-600 transition-colors duration-200">
                        Stronger
                    </button>
                    <span id="conScore" class="text-xl font-bold text-red-700">0</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // References to DOM elements
        const topicInput = document.getElementById('topicInput');
        const generateBtn = document.getElementById('generateBtn');
        const debateContainer = document.getElementById('debateContainer');
        const proArgumentDiv = document.getElementById('proArgument');
        const conArgumentDiv = document.getElementById('conArgument');
        const proScoreSpan = document.getElementById('proScore');
        const conScoreSpan = document.getElementById('conScore');
        const proScoreBtn = document.getElementById('proScoreBtn');
        const conScoreBtn = document.getElementById('conScoreBtn');
        const messageBox = document.getElementById('messageBox');
        const messageText = document.getElementById('messageText');

        let proScore = 0;
        let conScore = 0;

        function showMessage(message) {
            messageText.textContent = message;
            messageBox.classList.remove('hidden');
        }

        function hideMessage() {
            messageBox.classList.add('hidden');
        }

        async function generateArguments() {
            const topic = topicInput.value.trim();
            if (!topic) { showMessage("Please enter a topic."); return; }

            hideMessage();
            generateBtn.disabled = true;
            debateContainer.classList.add('hidden');

            const proQuery = `Write a persuasive argument FOR the topic: '${topic}'.`;
            const conQuery = `Write a persuasive argument AGAINST the topic: '${topic}'.`;

            async function getArgument(query) {
                try {
                    const res = await fetch('/api/debate', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ query })
                    });
                    const data = await res.json();
                    if (!res.ok) throw new Error(data.error || `HTTP ${res.status}`);
                    return data.text;
                } catch (err) {
                    console.error("API call failed:", err);
                    throw err;
                }
            }

            try {
                const [proArgument, conArgument] = await Promise.all([getArgument(proQuery), getArgument(conQuery)]);
                proScore = 0; conScore = 0;
                proScoreSpan.textContent = proScore;
                conScoreSpan.textContent = conScore;
                proArgumentDiv.textContent = proArgument;
                conArgumentDiv.textContent = conArgument;
                debateContainer.classList.remove('hidden');
            } catch (err) {
                showMessage(`Error generating arguments: ${err.message}`);
            } finally {
                generateBtn.disabled = false;
            }
        }

        generateBtn.addEventListener('click', generateArguments);
        proScoreBtn.addEventListener('click', () => { proScore++; proScoreSpan.textContent = proScore; });
        conScoreBtn.addEventListener('click', () => { conScore++; conScoreSpan.textContent = conScore; });
        topicInput.addEventListener('keydown', e => { if(e.key==='Enter') generateArguments(); });
    </script>

</body>
</html>
